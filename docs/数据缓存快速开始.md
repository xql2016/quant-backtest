# æ•°æ®ç¼“å­˜å¿«é€Ÿå¼€å§‹

## ğŸ¯ 5åˆ†é’Ÿä¸Šæ‰‹æŒ‡å—

### ç¬¬1æ­¥ï¼šå®‰è£…ä¾èµ–

```bash
pip install pyarrow
```

### ç¬¬2æ­¥ï¼šä½¿ç”¨ç¼“å­˜åŠŸèƒ½

#### æ–¹æ³•1ï¼šä¸€è¡Œä»£ç ï¼ˆæœ€ç®€å•ï¼‰

```python
from cached_data_source import get_cached_stock_data
import datetime

# è‡ªåŠ¨ç¼“å­˜ï¼Œç¬¬äºŒæ¬¡è®¿é—®è¶…å¿«ï¼
df = get_cached_stock_data(
    code='000001',
    start_date=datetime.date(2024, 1, 1),
    end_date=datetime.date(2024, 12, 31),
    market='Aè‚¡',
    source_type='akshare'
)
```

#### æ–¹æ³•2ï¼šåŒ…è£…ç°æœ‰æ•°æ®æº

```python
from cached_data_source import create_cached_data_source
import datetime

# åˆ›å»ºå¸¦ç¼“å­˜çš„æ•°æ®æº
data_source = create_cached_data_source('akshare', cache_enabled=True)

# ä½¿ç”¨æ–¹å¼å’Œä¹‹å‰ä¸€æ¨¡ä¸€æ ·
df = data_source.fetch_data(
    '000001',
    datetime.date(2024, 1, 1),
    datetime.date(2024, 12, 31),
    market='Aè‚¡'
)

# ç¬¬ä¸€æ¬¡ï¼šğŸŒ ä»APIè·å–æ•°æ®: 000001 (3-10ç§’)
#       ğŸ’¾ æ•°æ®å·²ç¼“å­˜: 000001
# ç¬¬äºŒæ¬¡ï¼šğŸ¯ ä½¿ç”¨ç¼“å­˜æ•°æ®: 000001 (<0.1ç§’) âš¡
```

### ç¬¬3æ­¥ï¼šæŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡

```bash
python test/cache_tool.py
```

é€‰æ‹©èœå•é€‰é¡¹ï¼š
1. æŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡ â†’ çœ‹çœ‹ç¼“å­˜äº†å¤šå°‘æ•°æ®
2. åˆ—å‡ºæ‰€æœ‰ç¼“å­˜ â†’ æŸ¥çœ‹ç¼“å­˜åˆ—è¡¨

### ç¬¬4æ­¥ï¼šæµ‹è¯•ç¼“å­˜åŠŸèƒ½

```bash
python test/test_cache.py
```

éªŒè¯æ‰€æœ‰åŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚

## ğŸ‰ å®Œæˆï¼

ç°åœ¨ä½ çš„æ•°æ®è·å–é€Ÿåº¦ä¼šå¿« **30-300å€**ï¼

## ğŸ’¡ å®é™…æ•ˆæœå¯¹æ¯”

```python
import time
from cached_data_source import create_cached_data_source
import datetime

data_source = create_cached_data_source('akshare')

code = '000001'
start = datetime.date(2024, 1, 1)
end = datetime.date(2024, 12, 31)

# ç¬¬ä¸€æ¬¡è·å–ï¼ˆæ— ç¼“å­˜ï¼‰
t1 = time.time()
df1 = data_source.fetch_data(code, start, end, market='Aè‚¡')
time1 = time.time() - t1
print(f"ç¬¬ä¸€æ¬¡è·å–: {time1:.2f} ç§’")  # çº¦ 3-10 ç§’

# ç¬¬äºŒæ¬¡è·å–ï¼ˆæœ‰ç¼“å­˜ï¼‰
t2 = time.time()
df2 = data_source.fetch_data(code, start, end, market='Aè‚¡')
time2 = time.time() - t2
print(f"ç¬¬äºŒæ¬¡è·å–: {time2:.2f} ç§’")  # çº¦ 0.05 ç§’

print(f"é€Ÿåº¦æå‡: {time1/time2:.0f} å€ ğŸš€")  # çº¦ 60-200 å€
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
ç¬¬ä¸€æ¬¡è·å–: 5.32 ç§’
ğŸŒ ä»APIè·å–æ•°æ®: 000001
ğŸ’¾ æ•°æ®å·²ç¼“å­˜: 000001

ç¬¬äºŒæ¬¡è·å–: 0.08 ç§’
ğŸ¯ ä½¿ç”¨ç¼“å­˜æ•°æ®: 000001 (243 æ¡è®°å½•)

é€Ÿåº¦æå‡: 67 å€ ğŸš€
```

## ğŸ“Š ç¼“å­˜ç®¡ç†

### æŸ¥çœ‹ç¼“å­˜
```bash
python test/cache_tool.py
```

### æ¸…ç†ç¼“å­˜
```python
from cache_manager import CacheManager

cache_manager = CacheManager()

# æ¸…ç†è¿‡æœŸç¼“å­˜
cache_manager.cleanup_cache()

# æ¸…ç©ºæ‰€æœ‰ç¼“å­˜
cache_manager.clear_all_cache()
```

## âš™ï¸ é…ç½®ç¼“å­˜

ç¼–è¾‘ `cache/config.json`ï¼š

```json
{
  "cache_settings": {
    "enabled": true,
    "max_size_mb": 1024  // ç¼“å­˜æœ€å¤§å®¹é‡ (MB)
  }
}
```

## ğŸ“š æ›´å¤šä¿¡æ¯

- **å®Œæ•´æ–‡æ¡£**: [æ•°æ®ç¼“å­˜ä½¿ç”¨æŒ‡å—](æ•°æ®ç¼“å­˜ä½¿ç”¨æŒ‡å—.md)
- **æŠ€æœ¯ç»†èŠ‚**: [cache/README.md](../cache/README.md)
- **æµ‹è¯•è„šæœ¬**: `test/test_cache.py`
- **ç®¡ç†å·¥å…·**: `test/cache_tool.py`

## â“ å¸¸è§é—®é¢˜

**Q: ç¼“å­˜åœ¨å“ªé‡Œï¼Ÿ**
```
cache/data/ ç›®å½•
```

**Q: å¦‚ä½•ç¦ç”¨ç¼“å­˜ï¼Ÿ**
```python
data_source = create_cached_data_source('akshare', cache_enabled=False)
```

**Q: ç¼“å­˜å ç”¨å¤šå°‘ç©ºé—´ï¼Ÿ**
```python
from cache_manager import CacheManager
stats = CacheManager().get_statistics()
print(f"{stats['total_size_mb']} MB")
```

**Q: æ•°æ®ä¼šè‡ªåŠ¨æ›´æ–°å—ï¼Ÿ**
```
ä¼šï¼æ ¹æ®TTLç­–ç•¥ï¼š
- å†å²æ•°æ®ï¼šæ°¸ä¹…ç¼“å­˜
- è¿‘æœŸæ•°æ®ï¼š7å¤©æ›´æ–°
- å®æ—¶æ•°æ®ï¼š1å°æ—¶æ›´æ–°
```

## ğŸ¯ ä¸‹ä¸€æ­¥

1. âœ… åœ¨ä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨ç¼“å­˜åŠŸèƒ½
2. âœ… äº«å—æé€Ÿçš„æ•°æ®è·å–ä½“éªŒ
3. âœ… å®šæœŸæŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡
4. âœ… é˜…è¯»å®Œæ•´æ–‡æ¡£äº†è§£æ›´å¤šåŠŸèƒ½

---

**å¼€å§‹ä½¿ç”¨å§ï¼** ğŸš€
