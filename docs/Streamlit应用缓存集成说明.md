# Streamlit åº”ç”¨é›†æˆç¼“å­˜åŠŸèƒ½ - æ›´æ–°è¯´æ˜

## ğŸ“ æ›´æ–°å†…å®¹

### ä¿®æ”¹æ–‡ä»¶ï¼š`run_main.py`

#### 1. å¯¼å…¥ç¼“å­˜æ¨¡å—
```python
# åŸä»£ç ï¼š
from data_source import get_stock_data

# æ–°å¢ï¼š
from cached_data_source import get_cached_stock_data  # å¸¦ç¼“å­˜çš„æ•°æ®è·å–
```

#### 2. æ›¿æ¢æ•°æ®è·å–å‡½æ•°
```python
# åŸä»£ç ï¼ˆç¬¬ 287-291 è¡Œï¼‰ï¼š
df = get_stock_data(stock_code, start_date, end_date, ...)

# æ–°ä»£ç ï¼š
df = get_cached_stock_data(stock_code, start_date, end_date, ..., cache_enabled=True)
```

**æ•ˆæœï¼š**
- âœ… ç¬¬ä¸€æ¬¡è·å–æ•°æ®ï¼šä» API è·å– + è‡ªåŠ¨ç¼“å­˜
- âœ… ç¬¬äºŒæ¬¡è·å–ç›¸åŒæ•°æ®ï¼šç›´æ¥ä»ç¼“å­˜è¯»å–ï¼ˆæå¿«ï¼‰

#### 3. æ·»åŠ ç¼“å­˜ç®¡ç†ç•Œé¢ï¼ˆä¾§è¾¹æ åº•éƒ¨ï¼‰
- æ˜¾ç¤ºç¼“å­˜ç»Ÿè®¡ä¿¡æ¯
- æä¾›æ¸…ç†ç¼“å­˜æŒ‰é’®
- æä¾›æ¸…ç©ºç¼“å­˜æŒ‰é’®

## ğŸ¯ ä½¿ç”¨æ–¹æ³•

### 1. é‡å¯ Streamlit åº”ç”¨

**æ–¹å¼Aï¼šåœ¨ç»ˆç«¯ä¸­é‡å¯**
```bash
# åœæ­¢å½“å‰åº”ç”¨ï¼ˆCtrl+Cï¼‰
# ç„¶åé‡æ–°å¯åŠ¨
python -m streamlit run run_main.py
```

**æ–¹å¼Bï¼šStreamlit è‡ªåŠ¨é‡è½½**
- å¦‚æœ Streamlit å·²è¿è¡Œï¼Œå®ƒä¼šè‡ªåŠ¨æ£€æµ‹åˆ°æ–‡ä»¶å˜åŒ–
- ç‚¹å‡»æµè§ˆå™¨å³ä¸Šè§’çš„ "Rerun" æŒ‰é’®

### 2. æŸ¥çœ‹ç¼“å­˜æ•ˆæœ

#### ç¬¬ä¸€æ¬¡è¿è¡Œå›æµ‹ï¼š
```
æ­£åœ¨ä» Tushare (Aè‚¡/å¯è½¬å€º) æ‹‰å–æ•°æ®...
ï¼ˆéœ€è¦ 3-10 ç§’ï¼‰
```

**æŸ¥çœ‹ç»ˆç«¯è¾“å‡º**ï¼ˆä¼šçœ‹åˆ°è¿™äº›æ—¥å¿—ï¼‰ï¼š
```
2026-02-13 15:00:00,000 - CacheManager - INFO - ç¼“å­˜ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ
2026-02-13 15:00:00,000 - CacheManager - INFO - æŸ¥è¯¢ç¼“å­˜: tushare_a_stock_000001_20240101_20241231_1d
2026-02-13 15:00:00,000 - CacheManager - INFO - âŒ ç¼“å­˜æœªå‘½ä¸­
2026-02-13 15:00:05,000 - CacheManager - INFO - âœ… ç¼“å­˜ä¿å­˜æˆåŠŸ: tushare_a_stock_000001_20240101_20241231_1d (12.5 KB)
```

#### ç¬¬äºŒæ¬¡è¿è¡Œç›¸åŒå›æµ‹ï¼š
```
æ­£åœ¨ä» Tushare (Aè‚¡/å¯è½¬å€º) æ‹‰å–æ•°æ®...
ï¼ˆ<0.1 ç§’ï¼Œæå¿«ï¼ï¼‰
```

**æŸ¥çœ‹ç»ˆç«¯è¾“å‡º**ï¼š
```
2026-02-13 15:01:00,000 - CacheManager - INFO - æŸ¥è¯¢ç¼“å­˜: tushare_a_stock_000001_20240101_20241231_1d
2026-02-13 15:01:00,000 - CacheManager - INFO - âœ… ç¼“å­˜å‘½ä¸­
```

### 3. ç®¡ç†ç¼“å­˜

åœ¨ Streamlit ä¾§è¾¹æ åº•éƒ¨ï¼Œä½ ä¼šçœ‹åˆ°ï¼š

```
ğŸ“¦ æ•°æ®ç¼“å­˜
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ’¾ ç¼“å­˜ç»Ÿè®¡
ç¼“å­˜æ•°: 5 ä¸ª
å¤§å°: 125.6 MB

[ğŸ§¹ æ¸…ç†]  [ğŸ—‘ï¸ æ¸…ç©º]
```

- **æ¸…ç†**ï¼šåˆ é™¤è¿‡æœŸç¼“å­˜
- **æ¸…ç©º**ï¼šåˆ é™¤æ‰€æœ‰ç¼“å­˜

## ğŸ“Š æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

### æ–¹æ³•1ï¼šæŸ¥çœ‹ç»ˆç«¯è¾“å‡º
è¿è¡Œ Streamlit çš„ç»ˆç«¯ä¼šæ˜¾ç¤ºæ‰€æœ‰ç¼“å­˜æ—¥å¿—ã€‚

### æ–¹æ³•2ï¼šæŸ¥çœ‹æ—¥å¿—æ–‡ä»¶
```bash
cat cache/logs/cache_access.log
```

### æ–¹æ³•3ï¼šä½¿ç”¨ç®¡ç†å·¥å…·
```bash
python test/cache_tool.py
```

é€‰æ‹©ï¼š
1. æŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡
2. åˆ—å‡ºæ‰€æœ‰ç¼“å­˜
3. æŸ¥çœ‹æŒ‡å®šä»£ç çš„ç¼“å­˜è¯¦æƒ…

## ğŸ” éªŒè¯ç¼“å­˜æ˜¯å¦å·¥ä½œ

### æµ‹è¯•æ­¥éª¤ï¼š

1. **ç¬¬ä¸€æ¬¡å›æµ‹**ï¼ˆåˆ›å»ºç¼“å­˜ï¼‰
   - æ•°æ®æºï¼šTushare
   - å¸‚åœºï¼šAè‚¡
   - ä»£ç ï¼š000001
   - æ—¥æœŸï¼š2024-01-01 åˆ° 2024-12-31
   - ç‚¹å‡»"å¼€å§‹å›æµ‹"
   - **è§‚å¯Ÿæ—¶é—´**ï¼šçº¦ 3-10 ç§’

2. **ç¬¬äºŒæ¬¡å›æµ‹**ï¼ˆä½¿ç”¨ç¼“å­˜ï¼‰
   - ä½¿ç”¨ç›¸åŒçš„å‚æ•°å†æ¬¡å›æµ‹
   - **è§‚å¯Ÿæ—¶é—´**ï¼š< 0.1 ç§’ï¼ˆæå¿«ï¼‰âœ¨

3. **æŸ¥çœ‹ç¼“å­˜æ–‡ä»¶**
   ```bash
   ls -lh cache/data/tushare/a_stock/
   # åº”è¯¥èƒ½çœ‹åˆ°ï¼š000001_20240101_20241231.parquet
   ```

4. **æŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡**
   - ä¾§è¾¹æ åº•éƒ¨æŸ¥çœ‹ç¼“å­˜æ•°é‡
   - æˆ–è¿è¡Œï¼š`python test/cache_tool.py`

## ğŸ’¡ é¢„æœŸæ•ˆæœ

### ç¼“å­˜å‘½ä¸­æ—¶ï¼š
```
âœ… æ•°æ®è·å–ï¼š< 0.1 ç§’ï¼ˆä»ç¼“å­˜ï¼‰
âœ… ä¾§è¾¹æ æ˜¾ç¤ºï¼šç¼“å­˜æ•° +1
âœ… ç»ˆç«¯æ—¥å¿—ï¼šæ˜¾ç¤º "ç¼“å­˜å‘½ä¸­"
```

### ç¼“å­˜æœªå‘½ä¸­æ—¶ï¼š
```
ğŸŒ æ•°æ®è·å–ï¼š3-10 ç§’ï¼ˆä» APIï¼‰
ğŸ’¾ è‡ªåŠ¨ä¿å­˜åˆ°ç¼“å­˜
âœ… ä¸‹æ¬¡ä½¿ç”¨ä¼šæ›´å¿«
```

## ğŸ› é—®é¢˜æ’æŸ¥

### å¦‚æœæ²¡æœ‰çœ‹åˆ°ç¼“å­˜æ—¥å¿—ï¼š

1. **æ£€æŸ¥ç»ˆç«¯è¾“å‡º**
   - ç¡®ä¿æŸ¥çœ‹çš„æ˜¯è¿è¡Œ Streamlit çš„ç»ˆç«¯
   - ä¸æ˜¯ Cursor çš„å…¶ä»–ç»ˆç«¯

2. **æ£€æŸ¥æ—¥å¿—çº§åˆ«**
   ```python
   # åœ¨ run_main.py å¼€å¤´æ·»åŠ ï¼š
   import logging
   logging.basicConfig(level=logging.INFO)
   ```

3. **æ‰‹åŠ¨æµ‹è¯•ç¼“å­˜**
   ```bash
   python test/diagnose_cache.py
   ```

### å¦‚æœæ•°æ®æ²¡æœ‰ç¼“å­˜ï¼š

1. **æ£€æŸ¥ç½‘ç»œè¿æ¥**
   - Tushare API æ˜¯å¦å¯è®¿é—®
   - Token æ˜¯å¦æœ‰æ•ˆ

2. **æ£€æŸ¥æ–‡ä»¶æƒé™**
   ```bash
   ls -la cache/data/
   ```

3. **æŸ¥çœ‹é”™è¯¯ä¿¡æ¯**
   - ç»ˆç«¯æ˜¯å¦æœ‰æŠ¥é”™
   - Streamlit ç•Œé¢æ˜¯å¦æœ‰é”™è¯¯æç¤º

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [æ•°æ®ç¼“å­˜å¿«é€Ÿå¼€å§‹](docs/æ•°æ®ç¼“å­˜å¿«é€Ÿå¼€å§‹.md)
- [æ•°æ®ç¼“å­˜ä½¿ç”¨æŒ‡å—](docs/æ•°æ®ç¼“å­˜ä½¿ç”¨æŒ‡å—.md)
- [ç¼“å­˜åŠŸèƒ½æ£€æŸ¥æ¸…å•](docs/ç¼“å­˜åŠŸèƒ½æ£€æŸ¥æ¸…å•.md)

---

**æ›´æ–°æ—¥æœŸ**: 2026-02-13  
**ç‰ˆæœ¬**: v1.1.0  
**çŠ¶æ€**: âœ… å·²é›†æˆå¹¶å¯ç”¨
