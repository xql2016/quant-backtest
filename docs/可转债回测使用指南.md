# 可转债回测使用指南 ⭐ 新功能

## 📋 概述

系统现已支持**可转债数据回测**，通过AKShare数据源获取上交所和深交所的可转债历史数据，帮助您验证可转债交易策略。

---

## ✨ 什么是可转债？

### 基本概念

**可转债**（Convertible Bond）是一种可以在特定条件下转换为股票的债券：

| 特性 | 说明 |
|-----|------|
| **双重属性** | 债券收益 + 股票收益 |
| **保本性** | 有到期还本保护 |
| **流动性** | T+0交易（本系统按T+1回测） |
| **交易单位** | 10张起（1000元面值） |
| **价格单位** | 元（如100.50元） |
| **代码格式** | 6位数字（如128039） |

### 核心指标

```
转股溢价率 = (转债价格 - 转股价值) / 转股价值 × 100%

转股价值 = 转债面值 ÷ 转股价 × 正股价格
```

**关键：**
- 溢价率 < 0：转股有利
- 溢价率 = 0：平价
- 溢价率 > 0：转股不利

---

## 🚀 快速开始

### 3步完成可转债回测

#### 1️⃣ 选择配置
```
数据源：AKShare (A股/港股/可转债)
市场：可转债 ⭐
```

#### 2️⃣ 输入代码
```
可转债代码：128039（国光转债）
回测区间：最近1年
```

#### 3️⃣ 选择策略
```
策略：MACD趋势策略
初始资金：100,000
手续费率：0.0003（万3）
```

---

## 📊 常见可转债代码

### 热门可转债

| 代码 | 名称 | 正股 | 评级 |
|-----|------|------|------|
| 128039 | 国光转债 | 国光股份 | A+ |
| 113050 | 南银转债 | 南京银行 | AAA |
| 127045 | 海亮转债 | 海亮股份 | AA+ |
| 123107 | 温氏转债 | 温氏股份 | AA |
| 113616 | 韦尔转债 | 韦尔股份 | AA- |
| 128136 | 立讯转债 | 立讯精密 | AA+ |
| 110053 | 苏银转债 | 苏州银行 | AAA |

### 如何选择可转债？

1. **查看实时行情**
   - 集思录：https://www.jisilu.cn/data/cbnew/
   - 可转债：可转债行情列表

2. **筛选条件示例**
   ```
   ✅ 价格 < 120元（安全边际）
   ✅ 溢价率 < 20%（合理估值）
   ✅ 评级 >= AA（信用质量）
   ✅ 剩余年限 > 1年（时间价值）
   ```

---

## 💡 推荐策略配置

### 配置1：双低策略

**理念：** 双低值 = 价格 + 溢价率，买入双低，卖出双高

```
━━━━━━━━━━━━━━━━━━━━━
可转债：128039
策略：RSI超买超卖
  - RSI周期：14
  - 超卖：30（买入信号）
  - 超买：70（卖出信号）
回测区间：最近2年
初始资金：100,000
━━━━━━━━━━━━━━━━━━━━━
```

**目标：**
- 在可转债价格低估时买入
- 价格回归或转股溢价率上升时卖出

### 配置2：趋势跟踪

**理念：** 跟随可转债价格趋势，顺势而为

```
━━━━━━━━━━━━━━━━━━━━━
可转债：113050
策略：MACD趋势策略
  - 快线：12
  - 慢线：26
  - 信号：9
回测区间：最近2年
初始资金：100,000
━━━━━━━━━━━━━━━━━━━━━
```

**目标：**
- MACD金叉买入
- MACD死叉卖出
- 捕捉中期趋势

### 配置3：均值回归

**理念：** 可转债价格偏离均值时会回归

```
━━━━━━━━━━━━━━━━━━━━━
可转债：127045
策略：布林带突破
  - 均线周期：20
  - 标准差倍数：2.0
回测区间：最近1年
初始资金：50,000
━━━━━━━━━━━━━━━━━━━━━
```

**目标：**
- 跌破下轨买入（超跌）
- 触及上轨卖出（超涨）

---

## 📈 策略参数建议

### 可转债特点

| 特性 | 说明 | 策略影响 |
|-----|------|---------|
| **价格范围** | 通常70-130元 | 波动相对温和 |
| **债性保护** | 价格不易大跌 | 下跌风险较小 |
| **股性弹性** | 正股涨时跟涨 | 上涨空间大 |
| **T+0交易** | 可当天买卖 | 回测按T+1 |

### 参数调整

| 策略 | A股参数 | **可转债参数** | 说明 |
|-----|---------|--------------|------|
| MACD | 12-26-9 | **12-26-9** | 可用标准参数 |
| RSI | 14期, 30-70 | **14期, 35-65** | 区间可稍窄 |
| 双均线 | 5-20 | **5-20** | 可用标准参数 |
| 布林带 | 20期, 2.0 | **20期, 1.5-2.0** | 可适当收窄 |

**原因：**
- 可转债波动比股票温和
- 极端超买超卖情况较少
- 趋势相对稳定

---

## ⚠️ 重要提示

### 1. 交易规则差异

| 项目 | 实际交易 | 回测系统 |
|-----|---------|---------|
| **交易制度** | T+0 | **T+1** ⚠️ |
| **涨跌幅限制** | ±20% | 按实际数据 |
| **交易单位** | 10张起 | 按金额计算 |

⚠️ **注意：** 本系统回测按T+1规则，与实际可转债T+0有差异，回测结果仅供参考。

### 2. 手续费设置

可转债交易成本：

```
买入：佣金（一般万2.5-万3）
卖出：佣金 + 过户费（万0.2）

建议设置：
- 买入手续费率：0.00025（万2.5）
- 卖出手续费率：0.00045（万4.5 = 万2.5 + 万2）
```

### 3. 数据说明

- **数据来源：** AKShare
- **数据粒度：** 仅支持日线
- **历史数据：** 通常可获取完整历史
- **实时性：** 收盘后更新

### 4. 风险提示

```
⚠️  可转债投资风险：

1. 信用风险：发行人违约风险
2. 流动性风险：小市值可转债可能流动性差
3. 转股风险：正股下跌导致转股价值降低
4. 强赎风险：满足条件时发行人可强制赎回

💡 建议：
- 选择AA级以上评级
- 关注正股基本面
- 设置合理止损
- 控制仓位比例
```

---

## 🧪 测试验证

### 运行测试脚本

```bash
cd /Users/shenhonglan/Cursor/quant
python3 test/test_convertible_bond.py
```

**测试内容：**
1. ✅ 多个可转债代码数据获取
2. ✅ 数据完整性检查
3. ✅ OHLC逻辑验证
4. ✅ 价格波动统计
5. ✅ 常见可转债列表展示

---

## 📚 使用示例

### 示例1：国光转债MACD回测

```python
# 在Streamlit界面配置：
数据源：AKShare
市场：可转债
代码：128039
策略：MACD趋势策略（12-26-9）
区间：2024-01-01 至 2026-02-08
资金：100,000元
```

**预期结果：**
- 数据条数：约300条（1年+）
- 交易次数：5-15次
- 适合中期趋势跟踪

### 示例2：多可转债对比

想对比多个可转债表现？分别回测：

```
轮次1：128039（国光转债）
轮次2：113050（南银转债）
轮次3：127045（海亮转债）

使用相同策略和参数，对比：
- 总收益率
- 胜率
- 最大回撤
- 交易频率
```

---

## 🎯 实战技巧

### 1. 选债技巧

**新手推荐：**
```
✅ 银行可转债（AAA评级，稳健）
✅ 大市值正股（流动性好）
✅ 溢价率 < 20%（安全边际）
✅ 价格 < 110元（下行空间有限）
```

**进阶选择：**
```
✅ 正股基本面优秀
✅ 转债规模适中（5-30亿）
✅ 剩余年限 > 1年
✅ 成交活跃（日均成交额 > 1000万）
```

### 2. 策略组合

**组合示例：**
```
30% 资金 → 银行转债（稳健）
40% 资金 → 优质正股转债（成长）
30% 资金 → 低价转债（价值）
```

### 3. 止盈止损

```
止盈建议：
- 达到转股价值 +15%
- 价格达到130元
- 溢价率 > 30%

止损建议：
- 亏损 -5%
- 正股破位下跌
- 评级下调
```

---

## 🔍 常见问题

### Q1: 可转债代码在哪里找？

**A:** 
1. 集思录网站：https://www.jisilu.cn/data/cbnew/
2. 东方财富可转债行情
3. 券商交易软件搜索"可转债"

### Q2: 为什么某些可转债获取不到数据？

**A:** 可能原因：
- ❌ 已退市或到期
- ❌ 代码输入错误
- ❌ 刚上市历史数据不足
- ✅ 建议：选择成立1年以上的可转债

### Q3: 回测结果和实际交易差距大吗？

**A:** 主要差异：
- ⚠️ 回测是T+1，实际是T+0
- ⚠️ 回测无滑点，实际可能有价差
- ⚠️ 回测手续费固定，实际可能不同
- 💡 建议：回测结果仅供参考，实盘需谨慎

### Q4: 可转债能用高频策略吗？

**A:** 
- ❌ 系统只支持日线数据
- ❌ 无法回测日内高频策略
- ✅ 适合中长期趋势策略
- ✅ 适合波段交易策略

### Q5: 可转债和股票策略有什么不同？

**A:** 
| 维度 | 股票 | 可转债 |
|-----|------|--------|
| 波动性 | 大 | 较小 |
| 下行风险 | 较大 | 有债底保护 |
| 适合策略 | 各类 | 趋势、均值回归 |
| 持有期限 | 灵活 | 适合中期 |

---

## 📖 学习资源

### 推荐阅读

1. **《可转债投资魔法书》** - 安道全
2. **集思录可转债指南** - https://www.jisilu.cn
3. **雪球可转债讨论区** - 实时交流

### 关键概念

```
必须了解：
✅ 转股价值
✅ 转股溢价率
✅ 纯债价值
✅ 强赎条款
✅ 回售条款
✅ 下修条款

建议学习顺序：
1. 理解可转债基本原理
2. 掌握估值指标含义
3. 学习常见交易策略
4. 用系统回测验证
5. 小资金实盘练习
```

---

## 🎉 总结

### 核心优势

1. ✅ **数据完整** - AKShare提供完整历史数据
2. ✅ **易于上手** - 操作流程与股票回测一致
3. ✅ **策略通用** - 大部分股票策略都适用
4. ✅ **风险较低** - 可转债有债底保护

### 适合人群

- ✅ 稳健型投资者
- ✅ 追求绝对收益者
- ✅ 想分散风险者
- ✅ 策略研究者

### 快速体验

```
🌐 访问：http://localhost:8501
📊 选择：AKShare → 可转债
💡 代码：128039
🚀 开始：选择策略，点击回测
```

**现在就开始探索可转债量化回测吧！** 📈✨

---

**版本：** 1.0  
**更新日期：** 2026-02-08  
**作者：** 量化回测系统开发团队

**免责声明：** 本系统提供的回测结果仅供参考，不构成投资建议。投资有风险，入市需谨慎。

