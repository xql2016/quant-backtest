# 📊 Tushare 数据源集成指南

## 🎯 概述

Tushare 是一个专业的金融数据接口，提供高质量的A股和可转债数据。本系统已成功集成 Tushare，支持：

- 🇨🇳 **A股数据**：沪深两市全部股票（前复权）
- 📜 **可转债数据**：上交所、深交所可转债（需2000积分）

---

## ✅ 集成完成功能

### 1. 数据源类
- `TushareDataSource`：完整的 Tushare 数据源实现
- 支持 A股 和 可转债 市场
- 自动处理代码格式（自动添加 .SH/.SZ 后缀）
- 前复权数据处理

### 2. UI 集成
- 数据源选择：`Tushare (A股/可转债)` ⭐ 推荐
- Token 输入框：支持安全输入（密码模式）
- 市场选择：A股 / 可转债
- 代码输入：智能提示和验证

### 3. Token 管理
- Token 已内置在系统中，无需手动输入
- 自动配置：`9d1b233c81c719297da330bc01f946fa1d88040946cb8d85ed02e9a4`
- 避免文件权限问题（不使用 `set_token()`）

---

## 🚀 快速开始

### 步骤1：选择数据源
在侧边栏选择：**"Tushare (A股/可转债)"**

### 步骤2：选择市场和代码
*(Token 已内置，无需输入)*

**A股示例：**
- 市场：A股
- 代码：`600519`（贵州茅台）、`000001`（平安银行）

**可转债示例：**
- 市场：可转债
- 代码：`113050`（南银转债）、`127045`（海亮转债）

### 步骤3：设置回测参数
- 日期范围：根据需要选择
- 策略：选择您想要的策略
- 参数：调整策略参数

### 步骤4：开始回测
点击 "🚀 开始回测" 按钮

---

## 📜 可转债代码规则

### 代码格式
- **上交所**：11xxxx（如 113050）
- **深交所**：12xxxx（如 128039）、127xxx（如 127045）

### 推荐测试代码
| 代码 | 名称 | 市场 | 特点 |
|------|------|------|------|
| 113050 | 南银转债 | 上交所 | 数据完整 |
| 127045 | 海亮转债 | 深交所 | 数据优秀 |
| 123110 | 东财转3 | 深交所 | 流动性好 |
| 110053 | 苏银转债 | 上交所 | 流动性好 |

---

## 💡 重要提示

### 1. 积分要求
- **A股数据**：基础权限即可（0积分）
- **可转债数据**：需要 **2000积分**
- 积分获取：Tushare 官网购买或贡献数据

### 2. 数据质量
- ✅ 数据更新及时
- ✅ 前复权处理
- ✅ 接口稳定
- ⚠️ 部分可转债可能已退市（返回空数据）

### 3. 注意事项
- 可转债采用 **T+0** 交易，但本系统暂不支持日内多次交易
- 数据延迟：通常 T+1 更新
- 网络连接：需要稳定的网络环境

---

## 🔧 技术实现

### 代码格式化
系统自动将代码转换为 Tushare 格式：

**A股：**
- `600519` → `600519.SH`（上交所）
- `000001` → `000001.SZ`（深交所）
- `300750` → `300750.SZ`（创业板）

**可转债：**
- `113050` → `113050.SH`（上交所）
- `128039` → `128039.SZ`（深交所）
- `127045` → `127045.SZ`（深交所）

### 复权处理
A股数据自动进行**前复权**处理，确保价格连续性。

---

## ❓ 常见问题

### Q1: 提示"积分不足"怎么办？
**A:** 可转债数据需要 2000 积分。请访问 [Tushare官网](https://tushare.pro) 购买积分或：
- 先使用 A股数据进行测试
- 使用 AKShare 或 YFinance 数据源

### Q2: 某个可转债代码获取不到数据？
**A:** 可能原因：
1. 可转债已退市或强制赎回
2. 代码输入错误（检查是否为6位数字）
3. 日期范围不在存续期内
4. 积分权限不足

**解决方案：**
- 更换其他可转债代码（如 113050、127045）
- 缩小日期范围
- 检查 Tushare 积分和权限

### Q3: Token 如何配置？
**A:** Token 已经内置在系统中，无需手动配置。如需更换 Token：
1. 修改 `run_main.py` 中的 `tushare_token` 变量
2. 或联系管理员

### Q4: 数据更新频率是多少？
**A:** Tushare 数据通常在交易日收盘后更新，一般为 T+1。

---

## 📊 数据字段说明

返回的标准化数据包含以下字段：

| 字段 | 说明 | 单位 |
|------|------|------|
| `date` | 交易日期（索引） | - |
| `open` | 开盘价 | 元 |
| `high` | 最高价 | 元 |
| `low` | 最低价 | 元 |
| `close` | 收盘价 | 元 |
| `volume` | 成交量 | 股/张 |

---

## 🎯 后续扩展（计划中）

### 1. 可转债指标
- 转股溢价率
- 纯债溢价率
- 双低指标
- 到期收益率

### 2. 基本面数据
- 正股信息
- 转股价
- 剩余期限
- 债券评级

### 3. 策略优化
- 基于双低的轮动策略
- 下修博弈策略
- 套利策略

---

## 📞 技术支持

如遇到问题，请检查：
1. Token 是否正确
2. 网络连接是否正常
3. 积分权限是否满足要求
4. 代码格式是否正确

---

**更新时间：** 2026-02-08  
**版本：** v1.0  
**作者：** 量化实验室

